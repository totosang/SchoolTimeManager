<!DOCTYPE html> <html lang="th"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>School Time Manager 0.2</title> <style>@import url('https://fonts.googleapis.com/css2?family=Kanit:wght@400;600&family=Quicksand:wght@600&display=swap');:root{--primary:#ea3397;--secondary:#45e36c;--bg-gradient:linear-gradient(135deg, #ffd6fd 0%, #cbf6ff 100%);--card-bg:rgba(255, 255, 255, 0.97);--flash-green:#27c97b}body{font-family:'Kanit','Quicksand',sans-serif;background:var(--bg-gradient);margin:0;padding:20px;min-height:100vh;text-align:center}.container{max-width:1000px;margin:0 auto;padding:30px 20px;background:var(--card-bg);border-radius:32px;box-shadow:0 12px 36px rgba(0,0,0,0.1)}.app-header{display:flex;align-items:center;justify-content:center;gap:15px;margin-bottom:25px}.main-title{font-size:2rem;color:var(--primary);background:linear-gradient(90deg, #e1ffe8, #fff0f7);padding:10px 25px;border-radius:20px;font-weight:700;box-shadow:0 4px 15px rgba(0,0,0,0.05)}.form-row-btns{display:flex;justify-content:center;gap:10px;margin-bottom:20px;flex-wrap:wrap}button{font-family:Kanit,sans-serif;cursor:pointer;border:none;transition:all .2s;font-weight:600;outline:0}.btn-main{padding:10px 20px;border-radius:12px;background:#fff;color:#565874;box-shadow:0 2px 5px rgba(0,0,0,0.1)}.btn-main:hover{transform:translateY(-2px);box-shadow:0 4px 10px rgba(0,0,0,0.15)}.local-input-btn{background:#cbf6ff;color:#1463a7}#playingVideo{margin:20px 0;min-height:360px;border-radius:30px;background:#000;overflow:hidden;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 30px rgba(0,0,0,0.2)}.local-player,.yt{width:100%;aspect-ratio:16/9;max-width:850px}#playlistItems{list-style:none;padding:0;margin-top:30px}.playlist-item{background:linear-gradient(95deg, #ffe0f6, #e8fff8);border:2px solid #f5a6ed;border-radius:22px;margin-bottom:20px;padding:20px;display:flex;flex-direction:column;gap:15px;position:relative;transition:all .3s}.playlist-item.active{border:3px solid #67d7ff;box-shadow:0 0 20px rgba(103,215,255,0.4)}.input-group{display:flex;align-items:center;gap:8px;flex-wrap:wrap}input[type=text]{padding:8px 12px;border-radius:10px;border:1.5px solid #b7edcf;font-family:Kanit,sans-serif;outline:0;transition:all .3s ease}@keyframes flashGreen{0%{background-color:#fff;border-color:var(--flash-green);box-shadow:0 0 0 var(--flash-green)}50%{background-color:#e7ffee;border-color:var(--flash-green);box-shadow:0 0 15px var(--flash-green)}100%{background-color:#f0fff4;border-color:var(--flash-green);box-shadow:0 0 0 var(--flash-green)}}.flash-success{animation:flashGreen .6s ease-out;border-color:var(--flash-green)!important;background-color:#f0fff4}.input-red{border-color:#fa5f7c!important}.input-green{border-color:#27c97b!important;background:#f0fff4}.list-number{background:#3ec694;color:#fff;border-radius:50%;width:35px;height:35px;display:flex;align-items:center;justify-content:center}.volume-control{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.5);padding:5px 12px;border-radius:10px}.time-badge{background:#fff;padding:2px 8px;border-radius:8px;border:1px solid #d1d1d1;display:inline-flex;align-items:center;gap:5px;margin:2px}.remove-time{color:#ff4c4c;font-weight:700;font-size:14px}.footer{margin-top:40px;font-size:.9rem;color:#666;line-height:1.6}@media (max-width:768px){.input-group{flex-direction:column;align-items:stretch}#playingVideo{min-height:200px}}</style> </head> <body> <div class="container"> <div class="app-header"> <span class="main-title">üë®‚Äçüè´ School Time Manager ‚è∞</span> </div> <div class="form-row-btns"> <button class="btn-main" onclick="document.getElementById('openFile').click()">üìÇ Open</button> <input type="file" id="openFile" accept=".stmplaylist,.json" style="display:none"> <button class="btn-main" id="saveBtn">üíæ Save File</button> <button class="btn-main local-input-btn" onclick="document.getElementById('localInputFile').click()">üéµ Input Media</button> <input type="file" id="localInputFile" accept="audio/*,video/*" style="display:none"> </div> <h2 style="font-size: 1.2rem;">üé¨ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</h2> <div id="playingVideo"><div style="color: white;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô</div></div> <h2 style="font-size: 1.2rem; margin-top: 30px;">üìù ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á/‡∏™‡∏∑‡πà‡∏≠</h2> <ul id="playlistItems"></ul> <div class="footer"> ¬© Copyright 2026 ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‡∏ú‡∏≠.‡∏£‡∏±‡∏ê‡∏Å‡∏£‡∏ì‡πå ‡∏≠‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå<br> ‡∏ú‡∏≠.‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ä‡∏≤‡∏¢‡∏ó‡∏∞‡πÄ‡∏•‡πÇ‡∏Ñ‡∏Å‡∏Ç‡∏≤‡∏°‡∏°‡∏¥‡∏ï‡∏£‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà 95 </div> </div> <script>const dbName="SchoolTimeManagerDB",storeName="AppData";function openDB(){return new Promise((e,t)=>{const a=indexedDB.open(dbName,1);a.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(storeName)||t.createObjectStore(storeName)},a.onsuccess=t=>e(t.target.result),a.onerror=e=>t(e.target.error)})}async function saveToDB(e,t){const a=await openDB(),n=a.transaction(storeName,"readwrite");return n.objectStore(storeName).put(t,e),new Promise(e=>{n.oncomplete=()=>e()})}async function getFromDB(e){const t=await openDB();return new Promise(a=>{const n=t.transaction(storeName).objectStore(storeName).get(e);n.onsuccess=()=>a(n.result)})}let player,scheduledPlaylist=[],fieldState=[],playingNow=!1,currentVideoIdx=null,base64Data={};async function syncAllData(){await saveToDB("scheduledPlaylist",scheduledPlaylist),await saveToDB("base64Data",base64Data)}function flashInput(e){e.classList.remove("flash-success"),void e.offsetWidth,e.classList.add("flash-success")}function pressEnter(e,t,a){"Enter"===e.key&&(e.preventDefault(),t(),a&&flashInput(a))}document.getElementById("localInputFile").addEventListener("change",e=>{const t=e.target.files[0];if(!t)return;const a=new FileReader;a.onload=async e=>{const n="local_"+Date.now();base64Data[n]={name:t.name,mime:t.type,base64:e.target.result.split(",")[1]},scheduledPlaylist.push({url:n,name:t.name.replace(/\.[^.]+$/,""),start:"0.0",end:"",scheduledTimes:[],lastPlayedMinute:"",volume:100,pauseBeforePlay:1,isLocal:!0,ext:t.name.split(".").pop()}),await syncAllData(),renderPlaylist()},a.readAsDataURL(t)});function renderPlaylist(){const e=document.getElementById("playlistItems");e.innerHTML="",scheduledPlaylist.forEach((t,a)=>{fieldState[a]||(fieldState[a]={name:"red",link:"red",time:"red"});const n=document.createElement("li");n.className=`playlist-item ${currentVideoIdx===a&&playingNow?"active":""}`,n.innerHTML=`<div class="input-group"><span class="list-number">${a+1}</span><input type="text" class="edit-name ${"green"===fieldState[a].name?"input-green":"input-red"}" value="${t.name}" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏•‡∏á" style="flex: 2"><button class="save-name-btn">üíæ</button><input type="text" class="edit-link ${"green"===fieldState[a].link?"input-green":"input-red"}" value="${t.url}" placeholder="URL YouTube / Local ID" style="flex: 3"><button class="save-link-btn">üîó</button><button class="pause-btn" style="background:${t.pauseBeforePlay?"#ff4c4c":"#45e36c"}; color:#fff; border-radius:8px; padding:5px 10px;">${t.pauseBeforePlay?"‚è∏Ô∏è Pause":"‚ñ∂Ô∏è Auto"}</button><button class="play-btn" style="background: #eee; padding: 5px 10px; border-radius: 8px;">‚ñ∂Ô∏è Play Now</button><div class="volume-control">üîä <input type="range" class="vol-slider" min="0" max="100" value="${t.volume}"><span style="min-width: 40px;">${t.volume}%</span></div></div><div class="input-group">‚è±Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°: <input type="text" class="edit-start" value="${t.start}" style="width: 70px;">‡∏´‡∏¢‡∏∏‡∏î: <input type="text" class="edit-end" value="${t.end}" style="width: 70px;"><button class="save-time-btn">‚úÖ</button><span style="margin-left: 15px;">‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏•‡πà‡∏ô:</span><div style="flex: 1">${t.scheduledTimes.map((e,t)=>`<span class="time-badge">${e} <button class="remove-time" data-idx="${t}">√ó</button></span>`).join("")}<input type="text" class="new-time" placeholder="08:00" style="width: 60px;"><button class="add-time-btn">‚ûï</button></div></div><button class="remove-btn" style="position:absolute; top:10px; right:10px; background:none; color:red;">üóëÔ∏è</button>`;const l=n.querySelector(".edit-name"),s=async()=>{t.name=l.value,fieldState[a].name="green",await syncAllData(),flashInput(l)};l.onkeydown=e=>pressEnter(e,s,l),n.querySelector(".save-name-btn").onclick=s;const r=n.querySelector(".edit-link"),c=async()=>{t.url=r.value,fieldState[a].link="green",await syncAllData(),flashInput(r)};r.onkeydown=e=>pressEnter(e,c,r),n.querySelector(".save-link-btn").onclick=c;const i=n.querySelector(".edit-start"),o=n.querySelector(".edit-end"),u=async()=>{t.start=i.value,t.end=o.value,await syncAllData(),flashInput(i),flashInput(o)};i.onkeydown=o.onkeydown=e=>pressEnter(e,u,e.target),n.querySelector(".save-time-btn").onclick=u;const m=n.querySelector(".new-time"),d=async()=>{/^\d{2}:\d{2}$/.test(m.value)?(t.scheduledTimes.push(m.value),await syncAllData(),flashInput(m),setTimeout(renderPlaylist,500)):alert("‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ú‡∏¥‡∏î! (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô 08:00)")};m.onkeydown=e=>pressEnter(e,d,m),n.querySelector(".add-time-btn").onclick=d,n.querySelector(".vol-slider").onchange=async e=>{t.volume=e.target.value,currentVideoIdx===a&&setVolume(t.volume),await syncAllData(),renderPlaylist()},n.querySelector(".pause-btn").onclick=async()=>{t.pauseBeforePlay=!t.pauseBeforePlay,await syncAllData(),renderPlaylist()},n.querySelector(".play-btn").onclick=()=>playMedia(a),n.querySelector(".remove-btn").onclick=async()=>{confirm("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?")&&(scheduledPlaylist.splice(a,1),fieldState.splice(a,1),await syncAllData(),renderPlaylist())},n.querySelectorAll(".remove-time").forEach(e=>{e.onclick=async()=>{t.scheduledTimes.splice(e.dataset.idx,1),await syncAllData(),renderPlaylist()}}),e.appendChild(n)})}function playMedia(e){const t=scheduledPlaylist[e];if(!t||t.pauseBeforePlay&&!arguments[1])return;currentVideoIdx=e,playingNow=!0;const a=document.getElementById("playingVideo");if(t.isLocal&&base64Data[t.url]){const e=base64Data[t.url],n=e.mime.startsWith("video");a.innerHTML=`<${n?"video":"audio"} id="mainPlayer" class="local-player" controls autoplay src="data:${e.mime};base64,${e.base64}"></${n?"video":"audio"}>`;const l=document.getElementById("mainPlayer");if(l.volume=t.volume/100,l.currentTime=convertTime(t.start),t.end){const e=convertTime(t.end);l.ontimeupdate=()=>{l.currentTime>=e&&l.pause()}}l.onended=()=>(playingNow=!1,renderPlaylist())}else{const n=t.url.match(/(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/user\/\S+|\/ytscreeningroom\?v=))([\w\-]{11})/)?.[1];if(!n)return alert("YouTube URL ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");a.innerHTML='<div id="ytplayer"></div>',player=new YT.Player("ytplayer",{height:"100%",width:"100%",videoId:n,playerVars:{autoplay:1,start:convertTime(t.start),end:t.end?convertTime(t.end):void 0},events:{onReady:e=>e.target.setVolume(t.volume),onStateChange:e=>{0===e.data&&(playingNow=!1,renderPlaylist())}}})}renderPlaylist()}function convertTime(e){if(!e)return 0;const t=e.split(".");return 60*parseInt(t[0])+(t[1]?parseInt(t[1]):0)}function setVolume(e){player&&player.setVolume&&player.setVolume(e);const t=document.getElementById("mainPlayer");t&&(t.volume=e/100)}setInterval(async()=>{const e=new Date,t=e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0");scheduledPlaylist.forEach((e,a)=>{e.scheduledTimes.includes(t)&&e.lastPlayedMinute!==t&&!e.pauseBeforePlay&&(e.lastPlayedMinute=t,playMedia(a),syncAllData())})},1e3),window.onload=async()=>{const e=await getFromDB("scheduledPlaylist"),t=await getFromDB("base64Data");e&&(scheduledPlaylist=e),t&&(base64Data=t),fieldState=scheduledPlaylist.map(()=>({name:"green",link:"green",time:"green"})),renderPlaylist();const a=document.createElement("script");a.src="https://www.youtube.com/iframe_api",document.head.appendChild(a)},document.getElementById("saveBtn").onclick=()=>{const e=new Blob([JSON.stringify({playlist:scheduledPlaylist,base64Data},null,2)],{type:"application/json"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=`STM_Backup_${(new Date).toLocaleDateString()}.stmplaylist`,t.click()};</script> </body> </html>
